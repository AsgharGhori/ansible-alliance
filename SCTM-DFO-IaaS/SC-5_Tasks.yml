---
# Called from Windows-Unclassed.yml
# Includes all the tasks that fall under
# the SC-5 protocol requirements

- name: SC-5 A > Set computer to restart for updates even if user(s) logged in
  win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
    name: NoAutoRebootWithLoggedOnUsers
    data: 0
    type: dword
  when: SC_5 or SI_2

- name: SC-5 B > Limit unacknowledged data retransmission (IPv6)
  win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\TCPIP6\Parameters
    name: TcpMaxDataRetransmissions
    data: 3
    type: dword
  when: SC_5

- name: SC-5 C > Limit unacknowledged data retransmission
  win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters
    name: TcpMaxDataRetransmissions
    data: 3
    type: dword
  when: SC_5

- name: SC-5 D > Set keep-alive packet send interval
  win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters
    name: KeepAliveTime
    data: 300000
    type: dword
  when: SC_5

- name: SC-5 E > Disable IRDP Default Gateway configuration
  win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters
    name: PerformRouterDiscovery
    data: 0
    type: dword
  when: SC_5 or SC_23