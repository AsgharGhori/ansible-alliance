# Task Script
# Contains Tasks for handling all windows command editing.
# Called from a List Script

# Expected vars/facts:
# - MachineDefaults {} (populated and with SecCat_TaskCat: {} entry)
# - Rollbacks []
# - Skips []
# - SecCat
# - TaskCat
# - ComTask [] (looped)
#   - Desc
#   - ID
#   - Value
#   - Command
#   - Strip
---
- name: Initialize facts
  set_fact:
    Sec_Task: "{{ SecCat+'_'+TaskCat }}"
    skipVar: "{{ SecCat+'_'+TaskCat+'_'+ComTask.ID }}"

- name: "{{ Sec_Task+' '+ComTask.ID+' > '+ComTask.Desc }}"
  win_command: "{{ ComTask.Command + ((ComTask.Value if Sec_Task not in
    Rollbacks else MachineDefaults[Sec_Task][ComTask.ID])) }}"
  when : skipVar not in Skips