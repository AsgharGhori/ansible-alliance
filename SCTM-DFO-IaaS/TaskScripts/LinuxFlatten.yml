# == Task Script ==
# Contains tasks for flattening Linux files, effectively allowing
# use of single-line tools over multiple lines

# Expected Vars/Facts
# 
# 
---
- name: Load file contents
  slurp:
    src: /etc/xinetd.d/fakechargen
  register: fakeStuff

- debug:
    var: fakeStuff

- name: Decode contents
  set_fact:
    flatText: "{{ fakeStuff.content | b64decode }}"

- debug:
    var: flatText

- name:
  set_fact:
    matchedText: flatText | match("\\nservice chargen\\n{\\n        disable         = (yes|no)\\n")

- debug:
    var: matchedText

- name:
  set_fact:
    specificLine: "{{ flatText | select('\\nservice chargen\\n{\\n        disable         = (yes|no)\\n') }}"

- debug:
    var: specificLine