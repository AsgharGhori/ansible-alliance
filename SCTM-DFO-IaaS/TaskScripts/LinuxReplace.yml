# == Task Script ==
# Contains tasks for modifying parts of Linux files

# Expected vars/facts:
# - MachineDefaults {} (empty or populated)
# - SecCat
# - TaskCat
# - SwapTask {} (looped)
#   - Desc
#   - ID
#   - Value
#   - Path
#   - Regex
#   - Replace
---
- set_fact:
    fullID: "{{ SecCat+'_'+TaskCat+'_'+SwapTask.ID }}"

- name: "{{ fullID+' > '+SwapTask.Desc }}"
  replace:
    path: "{{ SwapTask.Path }}"
    regexp: "{{ SwapTask.Regex }}"
    replace: "{{ SwapTask.Replace + SwapTask.Value }}"
  register: thing
  when: not fullID in SkipList

- debug:
    var: thing