---
# Called from Windows-Unclassed.yml
# Includes all the tasks that fall under
# the AC-8 protocol requirements

## Task template
- name: AC-8 A > Set legal warning caption for logon and use of computer
  win_regedit:
    path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
    name: legalnoticecaption
    data: "Acceptable Use of Electronic Networks Policy DFO (DFO AUP)/ \
    Politique d’utilisation acceptable des réseaux électroniques du MPO (PUR MPO)"
    type: string

- name: AC-8 B > Set legal warning text for logon and use of computer
  win_regedit:
    path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
    name: legalnoticetext
    data: "\
    I acknowledge that both the Treasury Board Secretariat Policy and the \
    DFO Addendum on Acceptable Use of Electronic Networks apply to me as an \
    authorized user of DFO electronic networks, including the Internet. I \
    understand that I am obligated to access all DFO networks in a responsible \
    and informed way., I am aware that DFO monitors electronic networks as \
    indicated in the TBS Policy. As using these networks is a privilege, not a \
    right, I recognize that access may be revoked or a range of other disciplinary \
    or legal actions may be taken for conduct that does not conform to the above \
    policies. ----- Je reconnais que, en tant qu’utilisateur autorisé des réseaux \
    électroniques du MPO, y compris Internet, je dois respecter la politique du \
    Secrétariat du Conseil du Trésor (SCT) sur l’utilisation acceptable des réseaux \
    électroniques ainsi que le supplément du MPO. Je comprends que je dois agir \
    de manière responsable et réfléchie lorsque j’utilise les réseaux électroniques \
    du MPO., Je sais que le MPO surveille l’usage des réseaux électroniques \
    conformément à la politique du SCT. Comme il s’agit d’un privilège, et non d’un \
    droit, je reconnais que l’accès aux réseaux peut m’être refusé et que le \
    Ministère peut prendre des mesures disciplinaires ou judiciaires en cas \
    d’infraction."
    type: string

- name: AC-8 C > Restrict domain-cached logon information to 2 users
  win_regedit:
    path: HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
    name: CachedLogonsCount
    data: 2
    type: string

- name: AC-8 D > Set 14-day prompt for user to change password
  win_regedit:
    path: HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon
    name: PasswordExpiryWarning
    data: 14
    type: dword

- name: AC-8 E > Enforce digitally signing network server communications
  win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters
    name: requiresecuritysignature
    data: 1
    type: dword